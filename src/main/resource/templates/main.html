<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="layouts/base">
<head>
<title>メイン画面</title>
</head>
<body>
	<div layout:fragment="content">
		<header>
			<div id="example">
				<h1 th:text="${msg}"></h1>
			</div>
			<nav>
				<ul>
					<li><a href="/userlist">ユーザー一覧</a></li>
					<form action="/logout" method="POST">
						<p>
							<input type="submit" value="ログアウト"></input>
						</p>
					</form>
				</ul>
			</nav>
		</header>

		<form action="/tweets" method="post">
			<p>
				ツイート：
				<textarea cols="30" rows="3" name="tweet">
				
			</textarea>
			</p>
			<p>
				<input type="submit"></input>
			</p>
		</form>

		<div id="app">
			<div>
				<ul>
					<template v-for="tweet in result.list">
					<h2>{{ tweet.userName }}</h2>
					<p>{{ tweet.contents }}</p>
					</template>
				</ul>
			</div>
		</div>
		<script>
			new Vue({
				el : '#app',
				data : {
					result : {
						list : []
					}
				},
				created : function() {
					var that = this;
					$.ajax({
						type : "GET",
						url : "/tweets",
						dataType : "json",
						success : function(list) {
							// 成功時の処理としてリスト形式の結果を代入する
							// e.g. [{"title": "hoge", "text": "hogehoge"}, ...]
							that.result.list = list;
						}
					});
				}
			});
		</script>
	</div>

</body>
</html>